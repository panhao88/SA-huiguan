{"remainingRequest":"C:\\work\\workspace\\rock-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\workspace\\rock-ui\\src\\views\\rights\\Rights.vue?vue&type=style&index=0&id=355393f6&scoped=true&lang=scss&","dependencies":[{"path":"C:\\work\\workspace\\rock-ui\\src\\views\\rights\\Rights.vue","mtime":1611277175119},{"path":"C:\\work\\workspace\\rock-ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\workspace\\rock-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\work\\workspace\\rock-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\work\\workspace\\rock-ui\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\workspace\\rock-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\workspace\\rock-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouY29tbWVudHMgew0KICB3aWR0aDogNjAwcHg7DQogIGhlaWdodDogMTA5cHg7DQogIGJvcmRlcjogMXB4IHNvbGlkICNkY2RmZTY7DQogIHBhZGRpbmc6IDVweDsNCiAgY29sb3I6ICM2MDYyNjY7DQogIGZvbnQtc2l6ZTogaW5oZXJpdDsNCiAgb3V0bGluZTogbm9uZTsNCn0NCi9kZWVwLy5lbC10YWJsZSB0ZCwNCi5lbC10YWJsZSB0aCB7DQogIHBhZGRpbmc6IDZweCAwOw0KfQ0K"},{"version":3,"sources":["Rights.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0eA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Rights.vue","sourceRoot":"src/views/rights","sourcesContent":["<template>\r\n  <div>\r\n    <el-row>\r\n      <el-col :span=\"24\">\r\n        <el-card>\r\n          <div style=\"white-space: nowrap\">\r\n            <el-button type=\"primary\" @click=\"synchron\" size=\"mini\"\r\n              ><i class=\"el-icon-more\"></i> 权限同步</el-button\r\n            >\r\n            <el-button type=\"primary\" @click=\"refresh\" size=\"mini\"\r\n              ><i class=\"el-icon-refresh\"></i> 刷新权限缓存</el-button\r\n            >\r\n            <el-button type=\"primary\" size=\"mini\" @click=\"dialog = true\"\r\n              ><i class=\"el-icon-plus\"></i>新增权限菜单</el-button\r\n            >\r\n          </div>\r\n        </el-card>\r\n        <el-card>\r\n          <!-- 权限同步，刷新权限缓存，新增权限菜单 -->\r\n          <el-table\r\n            :data=\"allmenu\"\r\n            style=\"width: 100%; margin-top: 20px\"\r\n            border\r\n            align=\"center\"\r\n          >\r\n            <el-table-column\r\n              type=\"expand\"\r\n              label=\"#\"\r\n              prop=\"pname\"\r\n              width=\"40\"\r\n              align=\"center\"\r\n            >\r\n              <template slot-scope=\"props\">\r\n                <div\r\n                  style=\"border-top: 1px solid #f2f2f2\"\r\n                  v-if=\"props.row.children && props.row.children.length > 0\"\r\n                >\r\n                  <div v-for=\"(item, index) in props.row.children\" :key=\"index\">\r\n                    <div\r\n                      style=\"\r\n                        display: flex;\r\n                        align-items: center;\r\n                        border-bottom: 1px solid #f2f2f2;\r\n                      \"\r\n                    >\r\n                      <div style=\"padding: 5px\">\r\n                        <el-tag\r\n                          style=\"width: 100%\"\r\n                          closable\r\n                          @close=\"handleClose1(props.row, item)\"\r\n                          >{{ item.pname }}\r\n                          <i\r\n                            @click=\"handleEdit(index, item)\"\r\n                            class=\"iconfont icon-xiugai\"\r\n                            style=\"font-size: 12px; padding-left: 5px\"\r\n                          ></i\r\n                        ></el-tag>\r\n                      </div>\r\n                      <div>\r\n                        <div\r\n                          v-for=\"(item1, index1) in item.children\"\r\n                          :key=\"index1\"\r\n                          style=\"display: flex; align-items: center\"\r\n                        >\r\n                          <div style=\"padding: 5px\">\r\n                            <el-tag\r\n                              style=\"width: 100%\"\r\n                              type=\"success\"\r\n                              closable\r\n                              @close=\"handleClose2(props.row, item1)\"\r\n                              >{{ item1.pname }}\r\n                              <i\r\n                                class=\"iconfont icon-xiugai\"\r\n                                style=\"font-size: 12px; padding-right: 5px\"\r\n                              ></i\r\n                            ></el-tag>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div v-else>暂无数据</div>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              label=\"编号\"\r\n              width=\"60\"\r\n              align=\"center\"\r\n              prop=\"id\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              label=\"菜单名称\"\r\n              width=\"160\"\r\n              align=\"center\"\r\n              prop=\"pname\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              label=\"请求地址\"\r\n              prop=\"actionKey\"\r\n              width=\"220\"\r\n              align=\"center\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              prop=\"viewPath\"\r\n              label=\"页面路径\"\r\n              width=\"280\"\r\n              align=\"center\"\r\n            ></el-table-column>\r\n            <el-table-column label=\"图标\" align=\"center\" width=\"80\">\r\n              <template slot-scope=\"gpropsp\">\r\n                <div>\r\n                  <i :class=\"gpropsp.row.icon\"></i>\r\n                </div>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              prop=\"remark\"\r\n              label=\"描述\"\r\n              align=\"center\"\r\n              :show-overflow-tooltip=\"true\"\r\n            ></el-table-column>\r\n            <!-- 操纵 -->\r\n            <el-table-column label=\"操作\" align=\"center\" width=\"280\">\r\n              <template slot-scope=\"scope\">\r\n                <el-tooltip content=\"编辑角色\" placement=\"top\">\r\n                  <el-button\r\n                    size=\"mini\"\r\n                    @click=\"handleEdit(scope.$index, scope.row)\"\r\n                    type=\"primary\"\r\n                  >\r\n                    <span>修改</span>\r\n                  </el-button>\r\n                </el-tooltip>\r\n                <el-tooltip content=\"删除角色\" placement=\"top\">\r\n                  <el-button\r\n                    size=\"mini\"\r\n                    type=\"danger\"\r\n                    @click=\"handleDelete(scope.$index, scope.row)\"\r\n                  >\r\n                    <span>删除</span>\r\n                  </el-button>\r\n                </el-tooltip>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n          <!-- 编辑用户角色 -->\r\n          <el-dialog\r\n            title=\"修改权限菜单\"\r\n            :visible.sync=\"dialogFormVisible\"\r\n            width=\"40%\"\r\n            :modal-append-to-body=\"false\"\r\n          >\r\n            <el-form :model=\"ruleForm\" ref=\"ruleForm\">\r\n              <el-form-item\r\n                label=\"权限名称\"\r\n                :label-width=\"formLabelWidth\"\r\n                prop=\"roleName\"\r\n              >\r\n                <el-input v-model=\"ruleForm.permissions\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"请求地址\" :label-width=\"formLabelWidth\">\r\n                <el-input v-model=\"ruleForm.address\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"页面路径\" :label-width=\"formLabelWidth\">\r\n                <el-input v-model=\"ruleForm.Thepath\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"菜单图标\" :label-width=\"formLabelWidth\">\r\n                <el-input v-model=\"ruleForm.icon\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"类型\" :label-width=\"formLabelWidth\">\r\n                <el-select v-model=\"ruleForm.type\" placeholder=\"请选择\">\r\n                  <el-option\r\n                    v-for=\"item in tolist\"\r\n                    :key=\"item.id\"\r\n                    :value=\"item.id\"\r\n                    :label=\"item.name\"\r\n                  >\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item label=\"上级菜单\" :label-width=\"formLabelWidth\">\r\n                <el-cascader\r\n                  style=\"width: 34%\"\r\n                  v-model=\"ruleForm.pid\"\r\n                  :options=\"allmenu\"\r\n                  :props=\"selectProps\"\r\n                  clearable\r\n                  change-on-select\r\n                  @change=\"augment\"\r\n                ></el-cascader>\r\n              </el-form-item>\r\n              <el-form-item label=\"权限描述\" :label-width=\"formLabelWidth\">\r\n                <textarea\r\n                  class=\"comments\"\r\n                  v-model=\"ruleForm.vawenlue\"\r\n                  id=\"demo\"\r\n                >\r\n                </textarea>\r\n              </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n              <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n              <el-button type=\"primary\" @click=\"editor\">确 定</el-button>\r\n            </div>\r\n          </el-dialog>\r\n          <!-- 新增权限菜单 -->\r\n          <el-dialog\r\n            title=\"新增权限菜单\"\r\n            :visible.sync=\"dialog\"\r\n            width=\"40%\"\r\n            :modal-append-to-body=\"false\"\r\n          >\r\n            <el-form :model=\"validation\" ref=\"validation\" :rules=\"rules\">\r\n              <el-form-item\r\n                label=\"权限名称\"\r\n                :label-width=\"formLabelWidth\"\r\n                prop=\"permissions\"\r\n              >\r\n                <el-input v-model=\"validation.permissions\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item\r\n                label=\"请求地址\"\r\n                :label-width=\"formLabelWidth\"\r\n                prop=\"address\"\r\n              >\r\n                <el-input v-model=\"validation.address\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item\r\n                label=\"页面路径\"\r\n                :label-width=\"formLabelWidth\"\r\n                prop=\"Thepath\"\r\n              >\r\n                <el-input v-model=\"validation.Thepath\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item\r\n                label=\"菜单图标\"\r\n                :label-width=\"formLabelWidth\"\r\n                prop=\"icon\"\r\n              >\r\n                <el-input v-model=\"validation.icon\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item\r\n                label=\"类型\"\r\n                :label-width=\"formLabelWidth\"\r\n                prop=\"type\"\r\n              >\r\n                <el-select v-model=\"validation.type\" placeholder=\"请选择\">\r\n                  <el-option\r\n                    v-for=\"item in tolist\"\r\n                    :key=\"item.id\"\r\n                    :value=\"item.id\"\r\n                    :label=\"item.name\"\r\n                  >\r\n                  </el-option>\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item label=\"上级菜单\" :label-width=\"formLabelWidth\">\r\n                <!-- <el-input v-model=\"validation.pid\"></el-input> -->\r\n                <el-cascader\r\n                  style=\"width: 34%\"\r\n                  v-model=\"validation.pid\"\r\n                  :options=\"allmenu\"\r\n                  :props=\"selectProps\"\r\n                  clearable\r\n                  change-on-select\r\n                  @change=\"augment\"\r\n                ></el-cascader>\r\n              </el-form-item>\r\n              <el-form-item label=\"权限描述\" :label-width=\"formLabelWidth\">\r\n                <textarea\r\n                  class=\"comments\"\r\n                  v-model=\"validation.vawenlue\"\r\n                  id=\"demo\"\r\n                >\r\n                </textarea>\r\n              </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n              <el-button @click=\"dialog = false\">取 消</el-button>\r\n              <el-button type=\"primary\" @click=\"confirm('validation')\"\r\n                >确 定</el-button\r\n              >\r\n            </div>\r\n          </el-dialog>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { createNamespacedHelpers } from \"vuex\";\r\nconst userModule = createNamespacedHelpers(\"user\");\r\nconst { mapState: userState, mapActions: userActions } = userModule;\r\nexport default {\r\n  name: \"\",\r\n  props: {},\r\n  components: {},\r\n  data() {\r\n    return {\r\n      dialogFormVisible: false, //编辑权限\r\n      dialog: false, //新增权限菜单\r\n      id: \"\", //编辑获取的id\r\n      ruleForm: {\r\n        permissions: \"\",\r\n        address: \"\",\r\n        Thepath: \"\",\r\n        icon: \"\",\r\n        type: \"\",\r\n        pid: \"\",\r\n        vawenlue: \"\",\r\n      },\r\n      selectProps: {\r\n        value: \"id\",\r\n        label: \"pname\",\r\n        children: \"children\",\r\n      },\r\n      validation: {\r\n        permissions: \"\",\r\n        address: \"\",\r\n        Thepath: \"\",\r\n        icon: \"\",\r\n        type: \"\",\r\n        pid: \"\",\r\n        vawenlue: \"\",\r\n      },\r\n      rules: {\r\n        permissions: [\r\n          {\r\n            required: true,\r\n            message: \"权限名称不能为空\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        type: [\r\n          {\r\n            required: true,\r\n            message: \"权限名称不能为空\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n      },\r\n      tolist: [\r\n        {\r\n          id: 1,\r\n          name: \"菜单\",\r\n        },\r\n        {\r\n          id: 2,\r\n          name: \"按钮\",\r\n        },\r\n      ],\r\n      formLabelWidth: \"80px\",\r\n      arr_list: [],\r\n    };\r\n  },\r\n  methods: {\r\n    ...userActions([\r\n      \"getAllMenu\",\r\n      \"del\",\r\n      \"getupdate\",\r\n      \"synchronous\",\r\n      \"Therefresh\",\r\n      \"addpermissions\",\r\n    ]),\r\n    // 删除权限菜单\r\n    handleClose1(row, item) {\r\n      let id = item.id;\r\n      this.del({\r\n        id: id,\r\n      });\r\n    },\r\n    handleClose2(row, item1) {\r\n      let id = item1.id;\r\n      this.del({\r\n        id: id,\r\n      });\r\n    },\r\n    handleChange() {},\r\n    //删除权限\r\n    handleDelete(index, row) {\r\n      let id = row.id;\r\n      this.$confirm(\"此操作将永久删除该文件, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      })\r\n        .then(() => {\r\n          this.del({\r\n            id: id,\r\n          });\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: \"info\",\r\n            message: \"已取消删除\",\r\n          });\r\n        });\r\n    },\r\n    //编辑权限\r\n    handleEdit(index, row) {\r\n      this.id = row.id;\r\n      this.ruleForm.address = row.actionKey;\r\n      this.ruleForm.permissions = row.pname;\r\n      this.ruleForm.icon = row.icon;\r\n      if (row.ptype === \"1\") {\r\n        this.ruleForm.type = \"菜单\";\r\n      } else if (row.ptype === \"2\") {\r\n        this.ruleForm.type = \"按钮\";\r\n      }\r\n      this.ruleForm.vawenlue = row.remark;\r\n      this.dialogFormVisible = true;\r\n    },\r\n    // 权限同步\r\n    synchron() {\r\n      this.synchronous();\r\n    },\r\n    //刷新权限同步\r\n    refresh() {\r\n      this.Therefresh();\r\n    },\r\n    //新增权限菜单\r\n    confirm(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          this.dialog = false;\r\n          let arr = this.arr_list.pop().toString();\r\n          this.validation.pid = arr;\r\n          console.log(this.validation.pid);\r\n          this.addpermissions({\r\n            pname: this.validation.permissions,\r\n            actionKey: this.validation.address,\r\n            viewPath: this.validation.Thepath,\r\n            icon: this.validation.icon,\r\n            ptype: this.validation.type,\r\n            pid: this.validation.pid,\r\n            remark: this.validation.vawenlue,\r\n          });\r\n          (this.validation.permissions = \"\"),\r\n            (this.validation.address = \"\"),\r\n            (this.validation.Thepath = \"\"),\r\n            (this.validation.icon = \"\"),\r\n            (this.validation.type = \"\"),\r\n            (this.validation.pid = \"\"),\r\n            (this.validation.vawenlue = \"\");\r\n          this.arr_list = [];\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    augment(e) {\r\n      this.arr_list = JSON.parse(JSON.stringify(e));\r\n    },\r\n    //确认编辑权限\r\n    editor() {\r\n      let tyoelist = \"\";\r\n      if (this.ruleForm.type === \"菜单\") {\r\n        tyoelist = \"1\";\r\n      } else if (this.ruleForm.type === \"按钮\") {\r\n        tyoelist = \"2\";\r\n      }\r\n      let arr = this.arr_list.pop().toString();\r\n      this.ruleForm.pid = arr;\r\n      this.getupdate({\r\n        pname: this.ruleForm.permissions,\r\n        actionKey: this.ruleForm.address,\r\n        viewPath: this.ruleForm.Thepath,\r\n        icon: this.ruleForm.icon,\r\n        ptype: tyoelist,\r\n        pid: this.ruleForm.pid,\r\n        remark: this.ruleForm.vawenlue,\r\n        id: this.id,\r\n      });\r\n      this.dialogFormVisible = false;\r\n      this.arr_list = [];\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getAllMenu();\r\n  },\r\n  watch: {},\r\n  computed: {\r\n    ...userState([\"allmenu\", \"list\"]),\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang='scss'>\r\n.comments {\r\n  width: 600px;\r\n  height: 109px;\r\n  border: 1px solid #dcdfe6;\r\n  padding: 5px;\r\n  color: #606266;\r\n  font-size: inherit;\r\n  outline: none;\r\n}\r\n/deep/.el-table td,\r\n.el-table th {\r\n  padding: 6px 0;\r\n}\r\n</style>"]}]}